# Juju Log Parser

This is a python script that analyzes a Juju log file and creates tables that summarize how many units generated warnings, their names and number of messages grouped by severity.

## Usage

To run the script, you need to have python 3 installed on your system. You also need to have the PrettyTable module installed. You can install it using pip:

```bash
pip install prettytable
```

To run the script, you need to provide the name of the juju log file as the first command line argument. You can also provide an optional second argument, which is the name of a unit/charm for which to filter the results. For example:

```bash
python juju_log_analyzer.py example-debug.log nova-mysql-router
```

This will analyze the juju.log file and create a table that shows how many errors were generated by nova-mysql-router.

## Output

The script will print the tables to the standard output. It will give a summary based on message severity, how many duplicates, and which charm/unit (sorted alphabetically) produced the amount of messages.
An example output would look like this:

```
Charms that produced Warnings:
+---------------------------+------+-------+---------+-------+-------+
|      Charm/Unit Name      | Info | Debug | Warning | Error | Total |
+---------------------------+------+-------+---------+-------+-------+
|           glance          |  12  |   42  |    2    |   0   |   56  |
| glance-simplestreams-sync |  12  |   40  |    7    |   0   |   59  |
|          keystone         |  12  |   40  |    1    |   0   |   53  |
|    mysql-innodb-cluster   |  38  |  119  |    2    |   0   |  159  |
|        neutron-api        |  12  |   38  |    15   |   0   |   65  |
|   nova-cloud-controller   |  12  |   37  |    6    |   0   |   55  |
|        nova-compute       |  50  |  156  |    16   |   0   |  222  |
|        ovn-central        |  37  |  117  |    4    |   0   |  158  |
|         placement         |  12  |   40  |    2    |   0   |   54  |
|      rabbitmq-server      |  12  |   39  |    10   |   0   |   61  |
+---------------------------+------+-------+---------+-------+-------+
Rest of charms:
+----------------------------+------+-------+---------+-------+-------+
|      Charm/Unit Name       | Info | Debug | Warning | Error | Total |
+----------------------------+------+-------+---------+-------+-------+
|    glance-mysql-router     |  12  |   37  |    0    |   1   |   50  |
|        juju-generic        | 281  |  1219 |    0    |   21  |  1521 |
|   keystone-mysql-router    |  12  |   40  |    0    |   0   |   52  |
|   neutron-api-plugin-ovn   |  12  |   34  |    0    |   0   |   46  |
|    neutron-mysql-router    |  12  |   39  |    0    |   0   |   51  |
|     nova-mysql-router      |  12  |   38  |    0    |   0   |   50  |
|          octavia           |  37  |  116  |    0    |   10  |  163  |
| octavia-diskimage-retrofit |  12  |   38  |    0    |   0   |   50  |
|        ovn-chassis         |  24  |   75  |    0    |   0   |   99  |
|   placement-mysql-router   |  12  |   38  |    0    |   8   |   58  |
|           vault            |  12  |   37  |    0    |   7   |   56  |
|     vault-mysql-router     |  12  |   38  |    0    |   3   |   53  |
+----------------------------+------+-------+---------+-------+-------+
Amount of duplicates:
+------+-------+---------+-------+-------+
| Info | Debug | Warning | Error | Total |
+------+-------+---------+-------+-------+
|  56  |   44  |    1    |   0   |  101  |
+------+-------+---------+-------+-------+
Totals:
+------+-------+---------+-------+-------+
| Info | Debug | Warning | Error | Total |
+------+-------+---------+-------+-------+
| 659  |  2417 |    65   |   50  |  3191 |
+------+-------+---------+-------+-------+
```
## Limitations

The script assumes that the juju log file is well-formed and follows a standard format. It also assumes that each line in the log file starts with a unit name, followed by a colon, followed by a space, followed by a timestamp, followed by a space, followed by a message level, followed by a space, followed by a message. For example:

```text
unit-nova-mysql-router-0: 02:04:19 WARNING juju.worker.dependency "migration-fortress" manfold worker started at 2021-01-14 02:04:19.077586842 +0000 UTC
```

All messages that cannot be parsed to a unit/charm will be grouped to "juju-generic"

## License

This script is licensed under the MIT License. See [LICENSE](LICENSE) for more details.
